<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TED Ãœniversitesi Intranet</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>

  <!-- Ãœst MenÃ¼ -->
  <nav class="ted-nav">
    <div class="ted-nav__inner">
      <div class="ted-brand">
        <img src="logo.png" alt="TED Ãœniversitesi Logosu" />
        <span>TED Ãœniversitesi</span>
      </div>
      <ul class="ted-menu">
        <li><a href="index.html" class="active">Ana Sayfa</a></li>
        <li><a href="duyurular.html">Duyurular</a></li>
        <li><a href="etkinlikler.html">Etkinlikler</a></li>
        <li><a href="takvim.html">Akademik Takvim</a></li>
      </ul>
    </div>
  </nav>

  <!-- Sayfa Ä°Ã§eriÄŸi -->
  <main class="page">
    <div class="home-grid">

      <!-- Sol: HÄ±zlÄ± Link ButonlarÄ± -->
      <aside class="card">
        <div class="quick-links">
          <a href="#" class="ql">Ä°nsan KaynaklarÄ±</a>
          <a href="#" class="ql">KÃ¼tÃ¼phane</a>
          <a href="takvim.html" class="ql">Akademik Takvim</a>
          <a href="#" class="ql">Formlar</a>
        </div>
      </aside>

      <!-- Orta: Duyurular ve Etkinlikler -->
      <section>
        <div class="card">
          <h2>Son Duyurular</h2>
          <select>
            <option>Duyuru seÃ§iniz...</option>
            <option>Sosyal Sorumluluk Projesi</option>
            <option>Bahar Åženlikleri BaÅŸlÄ±yor</option>
            <option>KampÃ¼s Ä°Ã§in UlaÅŸÄ±m DÃ¼zenlemesi</option>
          </select>
          <p style="margin-top:10px;"><a href="duyurular.html">TÃ¼m duyurular â†’</a></p>
        </div>

        <div class="card" style="margin-top: 25px;">
          <h2>YaklaÅŸan Etkinlikler</h2>
          <select>
            <option>Etkinlik seÃ§iniz...</option>
            <option>Bilimsel AraÅŸtÄ±rma Semineri</option>
            <option>Kariyer GÃ¼nleri</option>
          </select>
          <p style="margin-top:10px;"><a href="etkinlikler.html">TÃ¼m etkinlikler â†’</a></p>
        </div>
      </section>

      <!-- SaÄŸ: Otomatik Hava Durumu -->
      <a id="weatherLink" href="https://www.mgm.gov.tr/" target="_blank" class="weather-link" rel="noopener">
        <aside class="weather" id="weatherBox">
          <h2>Hava Durumu</h2>
          <p id="weatherCity">Konum tespit ediliyor...</p>
          <p id="weatherInfo">YÃ¼kleniyor...</p>
        </aside>
      </a>

    </div>
  </main>

  <!-- Footer -->
  <footer class="ted-footer">
    Â© 2025 TED Ãœniversitesi â€¢ TÃ¼m HaklarÄ± SaklÄ±dÄ±r
  </footer>

  <!-- ðŸŒ¦ï¸ Hava Durumu Scripti -->
  <script>
    const weatherText = {
      0: "AÃ§Ä±k",
      1: "Az bulutlu",
      2: "ParÃ§alÄ± bulutlu",
      3: "Bulutlu",
      45: "Sisli",
      48: "KÄ±raÄŸÄ±lÄ± sis",
      51: "Hafif Ã§iseleme",
      53: "Ã‡iseleme",
      55: "Kuvvetli Ã§iseleme",
      61: "Hafif yaÄŸmur",
      63: "YaÄŸmur",
      65: "Kuvvetli yaÄŸmur",
      71: "Hafif kar",
      73: "Kar",
      75: "Kuvvetli kar",
      80: "Hafif saÄŸanak",
      81: "SaÄŸanak",
      82: "Kuvvetli saÄŸanak",
      95: "GÃ¶k gÃ¼rÃ¼ltÃ¼lÃ¼ fÄ±rtÄ±na"
    };

    async function getCoordinates() {
      return new Promise((resolve) => {
        if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition(
            (pos) => resolve({ lat: pos.coords.latitude, lon: pos.coords.longitude }),
            () => resolve({ lat: 39.93, lon: 32.85 }) // Ankara fallback
          );
        } else {
          resolve({ lat: 39.93, lon: 32.85 });
        }
      });
    }

    async function detectCity(lat, lon) {
      try {
        const res = await fetch(`https://nominatim.openstreetmap.org/reverse?lat=${lat}&lon=${lon}&format=json`);
        const data = await res.json();
        return (
          data.address.city ||
          data.address.town ||
          data.address.village ||
          "Ankara"
        );
      } catch {
        return "Ankara";
      }
    }

    async function loadWeather() {
      const cityEl = document.getElementById("weatherCity");
      const infoEl = document.getElementById("weatherInfo");
      const linkEl = document.getElementById("weatherLink");

      const { lat, lon } = await getCoordinates();
      const city = await detectCity(lat, lon);
      cityEl.textContent = city;

      try {
        const url = `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current_weather=true&timezone=auto`;
        const wRes = await fetch(url);
        const wData = await wRes.json();
        const cw = wData.current_weather;

        if (cw) {
          const temp = Math.round(cw.temperature);
          const desc = weatherText[cw.weathercode] || "Durum yok";
          infoEl.textContent = `${temp}Â°C â€“ ${desc.toLowerCase()}`;
        } else {
          infoEl.textContent = "Veri alÄ±namadÄ±.";
        }
      } catch {
        infoEl.textContent = "BaÄŸlantÄ± hatasÄ±.";
      }

      linkEl.href = `https://www.mgm.gov.tr/tahmin/il-ve-ilceler.aspx?il=${encodeURIComponent(city)}`;
    }

    loadWeather();
  </script>

</body>
</html>
