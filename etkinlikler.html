<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>TED √úniversitesi | Etkinlikler</title>
<link rel="stylesheet" href="common.css" />
<style>
/* === GENEL === */
body{margin:0;padding:0;background:#f6f8fb;font-family:"Segoe UI",sans-serif;display:flex;flex-direction:column;min-height:100vh;}
.hero{padding:36px 0;background:linear-gradient(90deg,#0a3763,#294f82);color:#fff;text-align:center;}
.hero h1{margin:0;}
.wrapper{flex:1;display:grid;grid-template-columns:260px 1fr 280px;column-gap:40px;padding:30px 40px;align-items:start;box-sizing:border-box;}

/* === SOL KATEGORƒ∞ === */
.categories-col{position:sticky;top:30px;align-self:start;}
.categories{background:#fff;border-radius:12px;box-shadow:0 2px 8px rgba(0,0,0,0.08);padding:16px;}
.categories h3{margin:0 0 8px;color:#002855;border-bottom:2px solid #002855;padding-bottom:6px;}
.categories ul{list-style:none;margin:0;padding:0;}
.categories li{padding:8px;border-radius:6px;cursor:pointer;transition:background .2s;}
.categories li:hover,.categories li.active{background:#e9eff8;color:#002855;font-weight:600;}

/* === GALERƒ∞ === */
.gallery{margin-top:18px;background:#fff;border-radius:12px;box-shadow:0 2px 8px rgba(0,0,0,0.08);padding:14px;}
.gallery .head{font-weight:700;color:#002855;margin-bottom:10px;}
.gallery button{width:100%;background:#f7f9fc;color:#002855;padding:10px;border-radius:8px;margin-bottom:8px;border:none;cursor:pointer;font-weight:600;text-align:left;transition:background .2s;}
.gallery button:hover{background:#e9eff8;}
.gallery .sublevel{margin-left:10px;margin-bottom:8px;border-left:2px solid #002855;padding-left:10px;}
.gallery .photo-list button{background:#fff;border:1px solid #d0d7e2;margin:3px 0;font-size:14px;}

/* === RESƒ∞M MODAL === */
.modal{display:none;position:fixed;z-index:1000;left:0;top:0;width:100%;height:100%;background:rgba(0,0,0,0.75);flex-direction:column;justify-content:center;align-items:center;}
.modal img{max-width:80%;max-height:70%;border-radius:8px;box-shadow:0 0 15px rgba(255,255,255,0.2);}
.modal-close{position:absolute;top:20px;right:30px;color:#fff;font-size:32px;cursor:pointer;}
#downloadBtn{display:block;color:#fff;background:#c8102e;text-decoration:none;padding:8px 12px;border-radius:6px;margin-top:10px;text-align:center;font-weight:600;}

/* === ORTA ETKƒ∞NLƒ∞KLER === */
.event-grid{display:flex;flex-direction:column;align-items:center;gap:25px;width:100%;min-height:400px;}
.event-card,.empty-box{background:#fff;border-radius:14px;box-shadow:0 3px 10px rgba(0,0,0,0.08);width:90%;max-width:1000px;margin:0 auto;}
.event-card{display:flex;align-items:center;overflow:hidden;transition:all .25s ease;}
.event-card:hover{transform:translateY(-3px);box-shadow:0 8px 18px rgba(0,40,85,0.15);}
.event-card img{width:300px;height:180px;object-fit:cover;}
.event-card .info{padding:16px 20px;flex:1;}
.event-card h3{margin:0 0 8px;color:#002855;font-weight:700;font-size:18px;}
.event-card p{margin:0;color:#333;}
.date{display:block;margin-top:6px;font-size:13px;color:#c8102e;}
.readmore{display:inline-block;margin-top:8px;background:#002855;color:#fff;padding:5px 9px;border-radius:5px;text-decoration:none;font-size:13px;}
.readmore:hover{background:#c8102e;}
.empty-box{padding:40px;text-align:center;color:#002855;font-weight:600;}

/* === SAƒû === */
.side{position:sticky;top:30px;align-self:start;}
.side .card{background:#fff;border-radius:12px;box-shadow:0 3px 10px rgba(0,0,0,0.08);overflow:hidden;margin-bottom:22px;}
.side .head{background:#002855;color:#fff;font-weight:600;padding:10px 14px;display:flex;justify-content:space-between;align-items:center;}
.side .body{padding:14px;}
table.cal{width:100%;border-collapse:collapse;text-align:center;}
.cal th{background:#f0f4f8;color:#002855;padding:8px;}
.cal td{padding:7px;border-radius:6px;cursor:pointer;}
.ev-past{background:#d4edda;color:#155724;}
.ev-upcoming{background:#fff3cd;color:#856404;}
.ev-updated{background:#f8d7da;color:#721c24;}
.ev-birthday{background:#cce5ff;color:#004085;}
.legend{margin-top:10px;font-size:13px;color:#002855;display:flex;gap:8px;flex-wrap:wrap;}
.legend span{background:#eef3fa;padding:2px 6px;border-radius:4px;}
.btn{display:block;width:100%;margin-top:12px;padding:10px 12px;border:none;border-radius:8px;font-weight:700;cursor:pointer;background:#002855;color:#fff;}
.btn:hover{background:#c8102e;}

/* === FORM MODAL (YAN KART ƒ∞√áƒ∞N) === */
.form-modal{display:none;position:fixed;z-index:1100;left:0;top:0;width:100%;height:100%;background:rgba(0,0,0,.6);align-items:center;justify-content:center;}
.form-box{width:90%;max-width:640px;background:#fff;border-radius:14px;box-shadow:0 8px 24px rgba(0,0,0,.18);padding:18px 20px;}
.form-box h3{margin:0 0 10px;color:#002855;}
.form-row{display:grid;grid-template-columns:1fr 1fr;gap:10px;}
.form-group{margin-top:8px;}
.form-group label{display:block;font-weight:600;margin-bottom:4px;color:#002855;}
.form-group input,.form-group select,.form-group textarea{width:100%;padding:9px;border:1px solid #d4dae5;border-radius:8px;box-sizing:border-box;}
.form-actions{display:flex;gap:10px;justify-content:flex-end;margin-top:12px;}
.form-actions .secondary{background:#eef3fa;color:#002855;}
.form-actions button{padding:10px 14px;border:none;border-radius:8px;font-weight:700;cursor:pointer;background:#002855;color:#fff;}
.form-close{position:absolute;right:16px;top:10px;font-size:26px;color:#555;cursor:pointer;}
.success-banner{display:none;margin-top:10px;padding:10px;border-radius:8px;background:#d4edda;color:#155724;font-weight:600;}
.error-banner{display:none;margin-top:10px;padding:10px;border-radius:8px;background:#f8d7da;color:#721c24;font-weight:600;}

/* === FOOTER === */
footer{background:#002855;color:#fff;text-align:center;padding:15px 0;font-size:14px;margin-top:auto;}
</style>
</head>
<body>

<header>
  <a href="index.html" class="home-link">
    <img src="logo.png" alt="TED √úniversitesi Logosu" />
    <span>TED √úniversitesi</span>
  </a>
  <nav>
    <a href="ogrenci.html">√ñƒürenci</a>
    <a href="akademik.html">Akademik Personel</a>
    <a href="idari.html">ƒ∞dari Personel</a>
    <a href="etkinlikler.html" class="active">Etkinlikler</a>
    <a href="iletisim.html">ƒ∞leti≈üim</a>
  </nav>
</header>

<section class="hero"><h1>Etkinlikler</h1></section>

<div class="wrapper">
  <!-- SOL -->
  <aside class="categories-col">
    <div class="categories">
      <h3>Kategoriler</h3>
      <ul id="categoryList">
        <li class="active" data-cat="all">T√ºm√º</li>
        <li data-cat="egitim">Eƒüitim</li>
        <li data-cat="seminer">Konferans / Seminer</li>
        <li data-cat="goster">Konser / G√∂steri</li>
        <li data-cat="musabaka">M√ºsabaka</li>
        <li data-cat="sergi">Sergi</li>
        <li data-cat="t√∂ren">T√∂ren</li>
        <li data-cat="diger">Diƒüer</li>
      </ul>
    </div>

    <section class="gallery">
      <div class="head">üì∏ Etkinlik Fotoƒüraf Galerisi</div>
      <div id="galleryContainer"></div>
    </section>
  </aside>

  <!-- ORTA -->
  <section id="eventGrid" class="event-grid"></section>

  <!-- SAƒû -->
  <aside class="side">
    <div class="card">
      <div class="head">
        <button id="prevMonth" style="background:none;border:none;color:#fff;font-size:18px;cursor:pointer">‚Äπ</button>
        <span id="monthYear"></span>
        <button id="nextMonth" style="background:none;border:none;color:#fff;font-size:18px;cursor:pointer">‚Ä∫</button>
      </div>
      <div class="body">
        <table class="cal"><thead><tr><th>P</th><th>S</th><th>√á</th><th>P</th><th>C</th><th>C</th><th>P</th></tr></thead><tbody id="calBody"></tbody></table>
        <div class="legend">
          <span style="background:#d4edda">Ge√ßmi≈ü</span>
          <span style="background:#fff3cd">Yakla≈üan</span>
          <span style="background:#f8d7da">G√ºncellenen</span>
          <span style="background:#cce5ff">Doƒüum G√ºn√º</span>
        </div>
      </div>
    </div>

    <div class="card">
      <div class="head">üóìÔ∏è Etkinlik A√ßƒ±klama</div>
      <div class="body">
        <ul id="eventList" style="list-style:none;padding:0;margin:0"></ul>
      </div>
    </div>

    <!-- üîπ BAƒûIMSIZ KART: Etkinlik Formu Olu≈ütur -->
    <div class="card">
      <div class="head">üìù Etkinlik Formu Olu≈ütur</div>
      <div class="body" style="text-align:center;">
        <button id="openFormBtn" class="btn" style="width:auto;display:inline-block;padding:10px 18px;">
          üìù Formu A√ß
        </button>
        <div id="formSuccess" class="success-banner">Form ba≈üarƒ±yla iletildi. Te≈üekk√ºr ederiz! üéâ</div>
        <div id="formError" class="error-banner">Bir sorun olu≈ütu. L√ºtfen daha sonra tekrar deneyin.</div>
      </div>
    </div>
  </aside>
</div>

<footer>¬© 2025 TED √úniversitesi ‚Ä¢ T√ºm Haklarƒ± Saklƒ±dƒ±r</footer>

<!-- üì∏ RESƒ∞M MODAL -->
<div id="imageModal" class="modal">
  <span class="modal-close" onclick="closeModal()">&times;</span>
  <img id="modalImage" src="" alt="Etkinlik Fotoƒürafƒ±" />
  <a id="downloadBtn" href="#" download>ƒ∞ndir</a>
</div>

<!-- üìù FORM MODAL -->
<div id="formModal" class="form-modal" aria-hidden="true">
  <div class="form-box">
    <span id="closeForm" class="form-close" aria-label="Kapat">√ó</span>
    <h3>Etkinlik Formu</h3>
    <form id="eventForm">
      <div class="form-row">
        <div class="form-group">
          <label for="fTitle">Etkinlik Adƒ±*</label>
          <input id="fTitle" type="text" required />
        </div>
        <div class="form-group">
          <label for="fDate">Tarih*</label>
          <input id="fDate" type="date" required />
        </div>
      </div>
      <div class="form-row">
        <div class="form-group">
          <label for="fCategory">Kategori</label>
          <select id="fCategory">
            <option value="egitim">Eƒüitim</option>
            <option value="seminer">Konferans / Seminer</option>
            <option value="sergi">Sergi</option>
            <option value="t√∂ren">T√∂ren</option>
            <option value="diger">Diƒüer</option>
          </select>
        </div>
        <div class="form-group">
          <label for="fOwner">Sorumlu Birim/Ki≈üi</label>
          <input id="fOwner" type="text" placeholder="√ñrn. M√ºhendislik Fak√ºltesi" />
        </div>
      </div>
      <div class="form-group">
        <label for="fDesc">A√ßƒ±klama</label>
        <textarea id="fDesc" rows="4" placeholder="Etkinlik hakkƒ±nda kƒ±sa a√ßƒ±klama..."></textarea>
      </div>
      <div class="form-row">
        <div class="form-group">
          <label for="fContactName">ƒ∞lgili Ki≈üi*</label>
          <input id="fContactName" type="text" required />
        </div>
        <div class="form-group">
          <label for="fContactMail">E-posta*</label>
          <input id="fContactMail" type="email" required />
        </div>
      </div>
      <div class="form-actions">
        <button type="button" class="secondary" id="cancelForm">Vazge√ß</button>
        <button type="submit">G√∂nder</button>
      </div>
    </form>
  </div>
</div>

<script>
/* ====== AYARLAR ====== */
const TEST_UNIT_EMAIL = "test.birim@tedu.edu.tr";   // üîß burayƒ± kurum adresinizle deƒüi≈ütirin
const BACKEND_ENDPOINT = "/api/send-event";         // üîß kurum i√ßi API yolu (opsiyonel)

/* === ETKƒ∞NLƒ∞K VERƒ∞LERƒ∞ === */
const events=[
  {title:"Bilimsel Ara≈ütƒ±rma Semineri",date:"2025-10-09",status:"upcoming",desc:"M√ºhendislik Fak√ºltesi tarafƒ±ndan d√ºzenlenen haftalƒ±k seminer serisi.",img:"https://images.unsplash.com/photo-1519389950473-47ba0277781c?auto=format&fit=crop&w=900&q=60",cat:"seminer"},
  {title:"Kariyer G√ºnleri (G√ºncellendi)",date:"2025-10-14",status:"updated",desc:"√ñƒürenciler ile sekt√∂r temsilcilerini bulu≈üturan etkinlik.",img:"https://images.unsplash.com/photo-1581090700227-1e37b190418e?auto=format&fit=crop&w=900&q=60",cat:"egitim"},
  {title:"Mezuniyet T√∂reni",date:"2025-09-28",status:"past",desc:"2025 yƒ±lƒ± mezuniyet t√∂reni kamp√ºs amfisinde d√ºzenlenecektir.",img:"https://images.unsplash.com/photo-1523580494863-6f3031224c94?auto=format&fit=crop&w=900&q=60",cat:"t√∂ren"},
  {title:"2025‚Äì2026 Tanƒ±tƒ±m G√ºn√º",date:"2025-11-02",status:"upcoming",desc:"Yeni √∂ƒürenciler ve aileleri i√ßin tanƒ±tƒ±m etkinliƒüi.",img:"https://images.unsplash.com/photo-1503676260728-1c00da094a0b?auto=format&fit=crop&w=900&q=60",cat:"egitim"},
  {title:"Bilim Fuarƒ±",date:"2025-11-18",status:"upcoming",desc:"√ñƒürencilerin hazƒ±rladƒ±ƒüƒ± projelerin sergilendiƒüi bilim fuarƒ±.",img:"https://images.unsplash.com/photo-1504384308090-c894fdcc538d?auto=format&fit=crop&w=900&q=60",cat:"sergi"}
];

/* === ORTA ETKƒ∞NLƒ∞KLER === */
const grid=document.getElementById('eventGrid');
function renderEvents(filter='all'){
  grid.innerHTML='';
  const filtered=events.filter(e=>e.status!=='birthday').filter(e=>filter==='all'||e.cat===filter);
  if(filtered.length===0){grid.innerHTML='<div class="empty-box">Bu alanda etkinlik bulunmamƒ±≈ütƒ±r.</div>';return;}
  filtered.forEach(e=>{
    const card=document.createElement('div');
    card.className='event-card';
    card.innerHTML=`<img src="${e.img}"><div class="info"><h3>${e.title}</h3><p>${e.desc}</p><span class="date">${e.date}</span><a class="readmore" href="#">Devamƒ±</a></div>`;
    grid.appendChild(card);
  });
}
renderEvents();
document.querySelectorAll('#categoryList li').forEach(li=>{
  li.addEventListener('click',()=>{
    document.querySelectorAll('#categoryList li').forEach(x=>x.classList.remove('active'));
    li.classList.add('active');renderEvents(li.dataset.cat);
  });
});

/* === TAKVƒ∞M === */
const monthYearEl=document.getElementById('monthYear'),calBody=document.getElementById('calBody'),eventList=document.getElementById('eventList');
let current=new Date();
function renderCal(){
  const y=current.getFullYear(),m=current.getMonth();
  monthYearEl.textContent=current.toLocaleString('tr-TR',{month:'long',year:'numeric'});
  const fd=(new Date(y,m,1).getDay()||7),days=new Date(y,m+1,0).getDate();
  calBody.innerHTML='';let d=1;
  for(let i=0;i<6;i++){
    const r=document.createElement('tr');
    for(let j=1;j<=7;j++){
      const c=document.createElement('td');
      if((i===0&&j<fd)||d>days){c.textContent='';}
      else{
        c.textContent=d;
        const ds=`${y}-${String(m+1).padStart(2,'0')}-${String(d).padStart(2,'0')}`;
        const evs=events.filter(e=>e.date===ds);
        if(evs.length>0)c.classList.add(`ev-${evs[0].status}`);
        c.onclick=()=>renderList(ds);
        d++;
      }
      r.appendChild(c);
    }
    calBody.appendChild(r);
  }
}
function renderList(sel=null){
  eventList.innerHTML='';
  const rel=events.filter(e=>e.date===sel);
  if(rel.length===0){eventList.innerHTML='<li>Bu tarih i√ßin etkinlik bulunmamaktadƒ±r.</li>';}
  else{rel.forEach(e=>{const li=document.createElement('li');li.innerHTML=`<strong>${e.title}</strong> ‚Äì ${e.desc}`;eventList.appendChild(li);});}
}
document.getElementById('prevMonth').onclick=()=>{current.setMonth(current.getMonth()-1);renderCal();renderList();};
document.getElementById('nextMonth').onclick=()=>{current.setMonth(current.getMonth()+1);renderCal();renderList();};
renderCal();renderList();

/* === GALERƒ∞ === */
const galleryData={
  "2025‚Äì2026 Akademik Yƒ±lƒ±":{
    "Tanƒ±tƒ±m G√ºn√º":["https://images.unsplash.com/photo-1503676260728-1c00da094a0b?auto=format&fit=crop&w=800&q=60"],
    "Bilim Fuarƒ±":["https://images.unsplash.com/photo-1504384308090-c894fdcc538d?auto=format&fit=crop&w=800&q=60",
                   "https://images.unsplash.com/photo-1556761175-5973dc0f32e7?auto=format&fit=crop&w=800&q=60"]
  },
  "2024‚Äì2025 Akademik Yƒ±lƒ±":{
    "Mezuniyet T√∂reni":[
      "https://images.unsplash.com/photo-1523580494863-6f3031224c94?auto=format&fit=crop&w=800&q=60",
      "https://images.unsplash.com/photo-1524995997946-a1c2e315a42f?auto=format&fit=crop&w=800&q=60"
    ],
    "Kariyer G√ºnleri":[
      "https://images.unsplash.com/photo-1581090700227-1e37b190418e?auto=format&fit=crop&w=800&q=60"
    ]
  }
};
const galleryContainer=document.getElementById("galleryContainer");
for(const [year,eventsY] of Object.entries(galleryData)){
  const yBtn=document.createElement("button");yBtn.textContent=year;
  const sub=document.createElement("div");sub.className="sublevel";sub.style.display="none";
  yBtn.onclick=()=>{const vis=sub.style.display==="block";document.querySelectorAll(".sublevel").forEach(e=>e.style.display="none");sub.style.display=vis?"none":"block";};
  for(const [ev,photos] of Object.entries(eventsY)){
    const eBtn=document.createElement("button");eBtn.textContent=ev;
    const pDiv=document.createElement("div");pDiv.className="sublevel photo-list";pDiv.style.display="none";
    eBtn.onclick=()=>{const open=pDiv.style.display==="block";document.querySelectorAll(".photo-list").forEach(el=>el.style.display="none");pDiv.style.display=open?"none":"block";};
    photos.forEach((url,i)=>{const pBtn=document.createElement("button");pBtn.textContent=`Fotoƒüraf ${i+1}`;pBtn.onclick=()=>openModal(url);pDiv.appendChild(pBtn);});
    sub.appendChild(eBtn);sub.appendChild(pDiv);
  }
  galleryContainer.appendChild(yBtn);galleryContainer.appendChild(sub);
}

/* === RESƒ∞M MODAL === */
function openModal(url){
  const modal=document.getElementById("imageModal");
  const img=document.getElementById("modalImage");
  const dl=document.getElementById("downloadBtn");
  img.src=url;dl.href=url;dl.setAttribute("download","etkinlik_fotografi.jpg");
  dl.onclick=(e)=>{e.stopPropagation();};
  modal.style.display="flex";
}
function closeModal(){document.getElementById("imageModal").style.display="none";}

/* === FORM MODAL A√á/KAPAT === */
const formModal=document.getElementById('formModal');
document.getElementById('openFormBtn').onclick=()=>{formModal.style.display='flex';formModal.setAttribute('aria-hidden','false');};
document.getElementById('closeForm').onclick=closeFormModal;
document.getElementById('cancelForm').onclick=closeFormModal;
function closeFormModal(){formModal.style.display='none';formModal.setAttribute('aria-hidden','true');}

/* === FORM G√ñNDER === */
document.getElementById('eventForm').addEventListener('submit', async (e)=>{
  e.preventDefault();
  const title = document.getElementById('fTitle').value.trim();
  const date  = document.getElementById('fDate').value;
  const cat   = document.getElementById('fCategory').value;
  const owner = document.getElementById('fOwner').value.trim();
  const desc  = document.getElementById('fDesc').value.trim();
  const cName = document.getElementById('fContactName').value.trim();
  const cMail = document.getElementById('fContactMail').value.trim();

  const payload = { title, date, category:cat, owner, description:desc, contactName:cName, contactMail:cMail };

  // 1) Kurum i√ßi API varsa deneyelim
  let sent = false;
  try{
    const res = await fetch(BACKEND_ENDPOINT, {
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body: JSON.stringify(payload)
    });
    if(res.ok){ sent = true; }
  }catch(_){ /* sessiz yedek */ }

  if(!sent){
    // 2) Yedek: mailto ile e-posta taslaƒüƒ± a√ß
    const subject = encodeURIComponent(`[Etkinlik Talebi] ${title} ‚Äì ${date}`);
    const body = encodeURIComponent(
`Etkinlik Adƒ±: ${title}
Tarih: ${date}
Kategori: ${cat}
Sorumlu Birim/Ki≈üi: ${owner}
A√ßƒ±klama: ${desc}

ƒ∞lgili Ki≈üi: ${cName}
ƒ∞leti≈üim E-posta: ${cMail}`
    );
    window.location.href = `mailto:${TEST_UNIT_EMAIL}?subject=${subject}&body=${body}`;
  }

  // Kullanƒ±cƒ±ya bildirim
  document.getElementById('formSuccess').style.display='block';
  document.getElementById('formError').style.display='none';
  closeFormModal();
  e.target.reset();
});
</script>
</body>
</html>
